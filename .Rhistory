results[[4]]
results[[5]]
results[[6]]
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusTree"]])
heatmap(results[[2]][["consensusMatrix"]])
expr_df = t(expr_df[, c(2:ncol(expr_df))])
expr_df <- read_csv("data_visual/gene_expression.csv")
mads=apply(d,1,mad)
expr_df = t(expr_df[, c(2:ncol(expr_df))])
expr_df=expr_df[rev(order(mads))[1:5000],]
results = ConsensusClusterPlus(t(expr_df),maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
expr_df = sweep(expr_df,1, apply(d,1,median,na.rm=T))
results = ConsensusClusterPlus(t(expr_df),maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
expr_df <- read_csv("data_visual/gene_expression.csv")
mads=apply(d,1,mad)
expr_df = t(expr_df[, c(2:ncol(expr_df))])
expr_df=expr_df[rev(order(mads))[1:5000],]
expr_df = sweep(expr_df,1, apply(expr_df,1,median,na.rm=T))
results = ConsensusClusterPlus(t(expr_df),maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusMatrix"]])
results = ConsensusClusterPlus(expr_df,maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusMatrix"]])
cna_df <- read_csv("data_visual/cnv.csv")
expr_df <- read_csv("data_visual/gene_expression.csv")
mutation_df <- read_csv("data_visual/mutation.csv")
methylation_df <- read_csv("data_visual/methylation.csv")
expr_df = t(expr_df[, c(2:ncol(expr_df))])
results = ConsensusClusterPlus(expr_df,maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusMatrix"]])
expr_df = t(expr_df[, c(2:ncol(expr_df))])
expr_df <- read_csv("data_visual/gene_expression.csv")
expr_df = t(expr_df[, c(2:ncol(expr_df))])
results = ConsensusClusterPlus(expr_df,maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusMatrix"]])
expr_df
results = ConsensusClusterPlus(expr_df,maxK=6,reps=50,pItem=0.8,pFeature=1,
title="title",clusterAlg="hc",distance="pearson",seed=1262118388.71279,plot="png")
results[[2]][["consensusTree"]]
heatmap(results[[2]][["consensusMatrix"]])
heatmap(results[[4]][["consensusMatrix"]])
heatmap(results[[5]][["consensusMatrix"]])
heatmap(results[[6]][["consensusMatrix"]])
heatmap(results[[7]][["consensusMatrix"]])
heatmap(results[[1]][["consensusMatrix"]])
heatmap(results[[2]][["consensusMatrix"]])
heatmap(results[[3]][["consensusMatrix"]])
encoded_df <- read_csv('ccl_encoded.csv')
library(tidyverse)
library(M3C)
library(ALL)
library(ConsensusClusterPlus)
encoded_df <- read_csv('ccl_encoded.csv')
encoded_df <- t(encoded_df[, c(2:ncol(encoded_df))])
encoded_df
results <- ConsensusClusterPlus(encoded_df, maxK = 6, reps = 50,
pItem = 0.8, pFeature = 1,
title = "title", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
results[[2]][["consensusTree"]]
heatmap(results[[3]][["consensusMatrix"]])
results[[3]][["consensusTree"]]
heatmap(results[[3]][["consensusMatrix"]])
heatmap(results[[4]][["consensusMatrix"]])
heatmap(results[[6]][["consensusMatrix"]])
results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "title", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
results[[4]][["consensusTree"]]
heatmap(results[[1]][["consensusMatrix"]])
expr_df <- read_csv("data_visual/gene_expression.csv")
# Different from python, col is sample, rows are features
expr_df <- t(expr_df[, c(2:ncol(expr_df))])
mads <- apply(d, 1, mad)
expr_df <- expr_df[rev(order(mads))[1:5000], ]
mads <- apply(expr_df, 1, mad)
expr_df <- expr_df[rev(order(mads))[1:5000], ]
expr_df <- sweep(expr_df, 1, apply(expr_df, 1, median, na.rm = TRUE))
results <- ConsensusClusterPlus(expr_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "title", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
library(tidyverse)
library(naniar)
library(SNFtool)
args <- commandArgs(trailingOnly = TRUE)
cna_df <- read_csv("data/visual_data/cnv.csv")
fpkm_df <- read_csv("data/visual_data/gene_expression.csv")
cna_df <- read_csv("data/data_visual/cnv.csv")
View(cna_df)
cna_df
dim(cna_df)
cna_df <- as.data.frame(cna_df[, -1])
cna_df
head(cna_df)
View(cna_df)
fpkm_df <- read_csv("data/data_visual/gene_expression.csv")
snv_df <- read_csv("data/data_visual/mutation.csv")
methylation_df <- read_csv("data/data_visual/methylation.csv")
fpkm_df <- as.data.frame(fpkm_df[, -1])
snv_df <- as.data.frame(snv_df[, -1])
methylation_df <- as.data.frame(methylation_df[, -1])
fpkm_df_normalized <- standardNormalization(fpkm_df)
cna_dist <- dist2(as.matrix(cna_df), as.matrix(cna_df))
fpkm_dist <- dist2(as.matrix(fpkm_df_normalized), as.matrix(fpkm_df_normalized))
snv_dist <- dist2(as.matrix(snv_df), as.matrix(snv_df))
methylation_dist <- dist2(as.matrix(methylation_df), as.matrix(methylation_df))
K <- 20 # number of neighbors, usually (10~30)
alpha <- 0.5 # hyperparameter, usually (0.3~0.8)
T <- 15 # Number of Iterations, usually (10~20)
W_cna <- affinityMatrix(cna_dist, K, alpha)
W_fpkm <- affinityMatrix(fpkm_dist, K, alpha)
W_snv <- affinityMatrix(snv_dist, K, alpha)
W_methylation <- affinityMatrix(methylation_dist, K, alpha)
W <- SNF(list(W_cna,W_fpkm), K, T)
str(W)
w_df <- as_tibble(W)
head(w_df)
K <- 20 # number of neighbors, usually (10~30)
alpha <- 0.5 # hyperparameter, usually (0.3~0.8)
T <- 15 # Number of Iterations, usually (10~20)
W_cna <- affinityMatrix(cna_dist, K, alpha)
W_fpkm <- affinityMatrix(fpkm_dist, K, alpha)
W_snv <- affinityMatrix(snv_dist, K, alpha)
W_methylation <- affinityMatrix(methylation_dist, K, alpha)
W <- SNF(list(W_cna,W_fpkm, W_snv, W_methylation), K, T)
str(W)
w_df <- as_tibble(W)
head(w_df)
write.csv(W, file = "data/processed_data/simlilarity_matrix.csv")
library(tidyverse)
library(M3C)
library(ALL)
library(ConsensusClusterPlus)
# readin
cna_df <- read_csv("data_visual/cnv.csv")
# readin
cna_df <- read_csv("data/data_visual/cnv.csv")
expr_df <- read_csv("data/data_visual/gene_expression.csv")
mutation_df <- read_csv("data/data_visual/mutation.csv")
methylation_df <- read_csv("data/data_visual/methylation.csv")
encoded_df <- read_csv('ccl_encoded.csv')
mutation_df
# Different from python, col is sample, rows are features
expr_df <- t(expr_df[, c(2:ncol(expr_df))])
cna_df <- t(cna_df[, c(2:ncol(cna_df))])
mutation_df <- t(mutation_df[, c(2:ncol(mutation_df))])
methylation_df <- t(methylation_df[, c(2:ncol(methylation_df))])
encoded_df
mofa_df <- read_csv('data/processed_data/similarity_matrix.csv')
mofa_df <- read_csv('data/processed_data/simliarity_matrix.csv')
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv')
mofa_df
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv', index=None)
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv')
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
# encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
mofa_df
results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
# encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
mofa_df <- as.matrix(mofa_df)
results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
encoded_df <- read_csv('ccl_encoded.csv')
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
encoded_df <- as.matrix(encoded_df)
results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "ENCODED", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
results <- ConsensusClusterPlus(MOFA_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "ENCODED", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results[[1]]
mofa_results
mofa_results[[2]]
mofa_results[[2]]$consensusClass
mofa_results[[2]]
mofa_results[[6]]$consensusClass
encoded_results[[6]]$consensusClass
cna_df <- read_csv("data/data_visual/cnv.csv")
fpkm_df <- read_csv("data/data_visual/gene_expression.csv")
snv_df <- read_csv("data/data_visual/mutation.csv")
methylation_df <- read_csv("data/data_visual/methylation.csv")
cna_df
encoded_results[[6]]$consensusClass
encoded_results[[6]]
mofa_df$cnames
mofa_df[1,]
col(mofa_df)
colnames(mofa_df)
# Different from python, col is sample, rows are features
expr_df <- t(expr_df[, c(2:ncol(expr_df))])
cna_df <- t(cna_df[, c(2:ncol(cna_df))])
mutation_df <- t(mutation_df[, c(2:ncol(mutation_df))])
methylation_df <- t(methylation_df[, c(2:ncol(methylation_df))])
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
mofa_df
# readin
#cna_df <- read_csv("data/data_visual/cnv.csv")
#expr_df <- read_csv("data/data_visual/gene_expression.csv")
#mutation_df <- read_csv("data/data_visual/mutation.csv")
#methylation_df <- read_csv("data/data_visual/methylation.csv")
encoded_df <- read_csv('ccl_encoded.csv')
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv')
# Different from python, col is sample, rows are features
#expr_df <- t(expr_df[, c(2:ncol(expr_df))])
#cna_df <- t(cna_df[, c(2:ncol(cna_df))])
#mutation_df <- t(mutation_df[, c(2:ncol(mutation_df))])
#methylation_df <- t(methylation_df[, c(2:ncol(methylation_df))])
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
encoded_df <- encoded_df[, c(2:ncol(encoded_df))]
mofa_df
encoded_df
# readin
#cna_df <- read_csv("data/data_visual/cnv.csv")
#expr_df <- read_csv("data/data_visual/gene_expression.csv")
#mutation_df <- read_csv("data/data_visual/mutation.csv")
#methylation_df <- read_csv("data/data_visual/methylation.csv")
encoded_df <- read_csv('ccl_encoded.csv')
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv')
# Different from python, col is sample, rows are features
#expr_df <- t(expr_df[, c(2:ncol(expr_df))])
#cna_df <- t(cna_df[, c(2:ncol(cna_df))])
#mutation_df <- t(mutation_df[, c(2:ncol(mutation_df))])
#methylation_df <- t(methylation_df[, c(2:ncol(methylation_df))])
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
colnames(mofa_df) <- colnames(encoded_df)
mofa_df
mofa_df <- as.matrix(mofa_df, )
encoded_df <- as.matrix(encoded_df)
mofa_results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "ENCODED", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results[[6]]$consensusClass
encoded_results[[6]]$consensusClass
mofa_results[[6]]$consensusClass
encoded_results[[6]]$consensusClass
cna_df <- read_csv("data/data_visual/cnv.csv")
fpkm_df <- read_csv("data/data_visual/gene_expression.csv")
snv_df <- read_csv("data/data_visual/mutation.csv")
methylation_df <- read_csv("data/data_visual/methylation.csv")
cna_df <- as.data.frame(cna_df[, -1])
fpkm_df <- as.data.frame(fpkm_df[, -1])
snv_df <- as.data.frame(snv_df[, -1])
methylation_df <- as.data.frame(methylation_df[, -1])
fpkm_df_normalized <- standardNormalization(fpkm_df)
cna_df <- standardNormalization(cna_df)
snv_df <- standardNormalization(snv_df)
methylation_df <- standardNormalization(methylation_df)
cna_dist <- dist2(as.matrix(cna_df), as.matrix(cna_df))
fpkm_dist <- dist2(as.matrix(fpkm_df_normalized), as.matrix(fpkm_df_normalized))
snv_dist <- dist2(as.matrix(snv_df), as.matrix(snv_df))
methylation_dist <- dist2(as.matrix(methylation_df), as.matrix(methylation_df))
K <- 20 # number of neighbors, usually (10~30)
alpha <- 0.5 # hyperparameter, usually (0.3~0.8)
T <- 15 # Number of Iterations, usually (10~20)
W_cna <- affinityMatrix(cna_dist, K, alpha)
W_fpkm <- affinityMatrix(fpkm_dist, K, alpha)
W_snv <- affinityMatrix(snv_dist, K, alpha)
W_methylation <- affinityMatrix(methylation_dist, K, alpha)
W <- SNF(list(W_cna,W_fpkm, W_snv, W_methylation), K, T)
str(W)
w_df <- as_tibble(W)
head(w_df)
write.csv(W, file = "data/processed_data/simlilarity_matrix.csv")
# readin
#cna_df <- read_csv("data/data_visual/cnv.csv")
#expr_df <- read_csv("data/data_visual/gene_expression.csv")
#mutation_df <- read_csv("data/data_visual/mutation.csv")
#methylation_df <- read_csv("data/data_visual/methylation.csv")
encoded_df <- read_csv('ccl_encoded.csv')
mofa_df <- read_csv('data/processed_data/simlilarity_matrix.csv')
# Different from python, col is sample, rows are features
#expr_df <- t(expr_df[, c(2:ncol(expr_df))])
#cna_df <- t(cna_df[, c(2:ncol(cna_df))])
#mutation_df <- t(mutation_df[, c(2:ncol(mutation_df))])
#methylation_df <- t(methylation_df[, c(2:ncol(methylation_df))])
mofa_df <- mofa_df[, c(2:ncol(mofa_df))]
colnames(mofa_df) <- colnames(encoded_df)
mofa_df <- as.matrix(mofa_df, )
encoded_df <- as.matrix(encoded_df)
mofa_results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
encoded_results <- ConsensusClusterPlus(encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "ENCODED", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results[[6]]$consensusClass
encoded_results[[6]]$consensusClass
encoded_results[[4]]$consensusClass
mofa_results[[4]]$consensusClass
encoded_results[[4]]$consensusTree
encoded_results[[4]]$clrs
encoded_results[[4]]$ml
heatmap(encoded_results[[4]]$ml)
mofa_results[[6]]$consensusClass
encoded_results[[6]]$consensusClass
write_csv(mofa_results[[6]]$consensusClass)
library(tidyverse)
library(M3C)
library(ALL)
library(ConsensusClusterPlus)
write_csv(mofa_results[[6]]$consensusClass)
write_csv(as.data.frame(mofa_results[[6]]$consensusClass))
write_csv(as.data.frame(mofa_results[[6]]$consensusClass), file='./')
write_csv(as.data.frame(mofa_results[[6]]$consensusClass), file='./mofa_clrs')
str(as.data.frame(mofa_results[[6]]$consensusClass))
mofa_results[[6]]$consensusClass)
mofa_results[[6]]$consensusClass
colnames(mofa_results[[6]]$consensusClass)
mofa_clrs = mofa_results[[6]]$consensusClass
write_csv(as.data.frame(mofa_results[[6]]$consensusClass),
col_names = colnames(encoded_df)
,file='./mofa_clrs')
write_csv(as.data.frame(mofa_results[[6]]$consensusClass),
col_names = colnames(encoded_df)
,file='./mofa_clrs')
write_csv(as.data.frame(mofa_results[[6]]$consensusClass),
col_names = colnames(encoded_df),file='./mofa_clrs')
colnames(mofa_clrs) <- colnames(mofa_df)
mofa_clrs = as.tibble(mofa_results[[6]]$consensusClass)
View(mofa_clrs)
mofa_clrs.T
t(mofa_clrs)
colnames(mofa_clrs) <- colnames(mofa_df)
as.tibble(mofa)
mofa_clrs
mofa_clrs = as.tibble(mofa_results[[6]]$consensusClass)
mofa_clrs = t(mofa_clrs)
mofa_clrs
dim(mofa_clrs)
colnames(mofa_clrs)
colnames(mofa_clrs) <- colnames(mofa_df)
mofa_clrs
encoded_clrs = as.tibble(encoded_results[[4]]$consensusClass)
encoded_clrs = t(encoded_clrs)
colnames(encoded_clrs) <- colnames(encoded_df)
write_csv(mofa_clrs, ,file='./mofa_clrs.csv')
write_csv(encoded_clrs, ,file='./encoded_clrs.csv')
write_csv(encoded_clrs ,file='./encoded_clrs.csv')
write_csv(mofa_clrs ,file='./mofa_clrs.csv')
write_csv(encoded_clrs ,file='./encoded_clrs.csv')
write_csv(mofa_clrs ,file='./mofa_clrs.csv')
write_csv(encoded_clrs ,file='./encoded_clrs.csv')
mofa_clrs
mofa_clrs = as.tibble(mofa_results[[4]]$consensusClass)
mofa_clrs = t(mofa_clrs)
colnames(mofa_clrs) <- colnames(mofa_df)
mofa_clrs
mofa_clrs <- as_tibble(mofa_clrs)
mofa_clrs
encoded_clrs <- as_tibble(encoded_clrs)
write_csv(mofa_clrs ,file='./mofa_clrs.csv')
write_csv(encoded_clrs ,file='./encoded_clrs.csv')
a <- read_csv('./heatmap.csv')
heatmap(a)
a
a <- a[, 1:ncol(a)]
heatmap(a)
a <- a[, 2:ncol(a)]
heatmap(a)
a
as.matrix(a)
heatmap(as.matrix(a))
heatmap(as.matrix(a), Rowv = NULL)
heatmap(as.matrix(a), Rowv = NA)
heatmap(as.matrix(a), Colv = NA)
a <- read_csv('./heatmap.csv')
a <- a[, 2:ncol(a)]
as.matrix(a)
heatmap(as.matrix(a), Colv = NA)
a <- read_csv('./heatmap.csv')
a <- a[, 2:ncol(a)]
as.matrix(a)
heatmap(as.matrix(a), Colv = NA)
heatmap(as.matrix(a), Colv = NA, na.rm = True)
heatmap(as.matrix(a), Colv = NA, na.rm = T)
heatmap(a, Colv = NA, na.rm = T)
as.tibble(a)
heatmap(a, Colv = NA, na.rm = T)
a
na.exclude(a)
heatmap(a, Colv = NA, na.rm = T)
fill(a, 0)
replace(my_dataframe, is.na(my_dataframe), 1)
replace(a, is.na(my_dataframe), 1)
replace(a, is.na(a), 1)
heatmap(a, Colv = NA, na.rm = T)
heatmap(as.matrix(a), Colv = NA, na.rm = T)
a <- replace(a, is.na(a), 1)
heatmap(as.matrix(a), Colv = NA, na.rm = T)
a <- read_csv('./heatmap.csv')
a <- a[, 2:ncol(a)]
a <- replace(a, is.na(a), 0)
heatmap(as.matrix(a), Colv = NA, na.rm = T)
heatmap(as.matrix(a), Colv = NA, na.rm = T, heatmap_legend_param = list(
color_bar = "continuous"
))
drug_encoded_df <- read_csv('drug_encoded.csv')
drug_encoded_df
drug_encoded_df <- as.matrix(drug_encoded_df)
mofa_results <- ConsensusClusterPlus(drug_encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results <- ConsensusClusterPlus(drug_encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "DRUG", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
drug_results <- ConsensusClusterPlus(drug_encoded_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "DRUG", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
mofa_results <- ConsensusClusterPlus(mofa_df, maxK = 10, reps = 50,
pItem = 0.8, pFeature = 1,
title = "MOFA", clusterAlg = "hc",
distance = "pearson", seed = 1262118388.71279,
plot = "png")
drug_clrs = as.tibble(drug_results[[5]]$consensusClass)
drug_encoded_clrs = t(drug_clrs)
drug_encoded_clrs
drug_clrs
drug_results[[5]]$consensusClass
colnames(drug_results[[5]]$consensusClass)
drug_results[[5]]$consensusClass
colnames(drug_encoded_df)
drug_clrs <- as_tibble(drug_encoded_clrs)
drug_clrs = as.tibble(drug_results[[5]]$consensusClass)
drug_encoded_clrs = t(drug_clrs)
colnames(drug_encoded_clrs) <- colnames(drug_encoded_df)
drug_clrs <- as_tibble(drug_encoded_clrs)
write_csv(drug_clrs, file='./drug_clrs.csv')
